var np={config:{appContainer:".notepad-app"},bShowStatusBar:!1,bWrap:!1,fontFamily:"Arial",fontStype:"常规",fontSize:"16",fontHandler:function(t){np.fontFamily=t.family,np.fontStype=t.style,np.fontSize=t.size,$editor.setFont(t)}};$(function(){$menubar.show(np.menuData),$editor.show(),$editor.setFont({family:np.fontFamily,style:np.fontStype,size:np.fontSize})});var $editor=function(){var e=$('<div class="notepad-editor"><textarea spellcheck="false"></textarea></div>'),n=e.find("textarea");return{show:function(){$("body").append(e),n.trigger("focus")},resize:function(t){t?e.css({bottom:"21px"}):e.css({bottom:"0"})},setFont:function(t){n.css({"font-family":t.family,"font-size":t.size+"pt"}),"斜体"!==t.style?"粗体"!==t.style?"粗偏斜体"!==t.style||n.css({"font-weight":"bold","font-style":"italic"}):n.css({"font-weight":"bold"}):n.css({"font-style":"italic"})}}}();np.menuData=[{title:"文件(F)",menuItems:[{title:"新建(N)",shortcut:"Ctrl+N",enabled:!0,handler:function(){console.log("新建(N) menu clicked!")}},{title:"打开(O)...",shortcut:"Ctrl+O",enabled:!0,handler:function(){console.log("打开(O) menu clicked!")}},{title:"保存(S)",shortcut:"Ctrl+S",enabled:!0,handler:function(){console.log("保存(S) menu clicked!")}},{title:"另存为(A)...",shortcut:"",enabled:!0,handler:function(){console.log("另存为(A) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"页面设置(U)...",shortcut:"",enabled:!0,handler:function(){console.log("页面设置(U) menu clicked!")}},{title:"打印(P)...",shortcut:"Ctrl+P",enabled:!0,handler:function(){console.log("打印(P) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"退出(X)",shortcut:"",enabled:!0,handler:function(){console.log("退出(X) menu clicked!")}}],width:"202px",left:"0px"},{title:"编辑(E)",menuItems:[{title:"撤销(U)",shortcut:"Ctrl+Z",enabled:!1,handler:function(){console.log("撤销(U) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"剪切(T)",shortcut:"Ctrl+X",enabled:!0,handler:function(){console.log("剪切(X) menu clicked!")}},{title:"复制(C)",shortcut:"Ctrl+C",enabled:!1,handler:function(){console.log("复制(C) menu clicked!")}},{title:"粘贴(P)",shortcut:"Ctrl+V",enabled:!1,handler:function(){console.log("粘贴(P) menu clicked!")}},{title:"删除(L)",shortcut:"Del",enabled:!1,handler:function(){console.log("删除(L) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"使用 Bing 搜索...",shortcut:"Ctrl+E",enabled:!0,handler:function(){console.log("使用 Bing 搜索 menu clicked!")}},{title:"查找(F)...",shortcut:"Ctrl+F",enabled:!1,handler:function(){console.log("查找(F) menu clicked!")}},{title:"查找下一个(N)",shortcut:"F3",enabled:!1,handler:function(){console.log("查找下一个(N) menu clicked!")}},{title:"替换(R)...",shortcut:"Ctrl+H",enabled:!0,handler:function(){console.log("替换(R) menu clicked!")}},{title:"转到(G)...",shortcut:"Ctrl+G",enabled:!0,handler:function(){console.log("转到(G) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"全选(A)",shortcut:"Ctrl+A",enabled:!0,handler:function(){console.log("全选(A) menu clicked!")}},{title:"时间/日期(D)",shortcut:"F5",enabled:!0,handler:function(){console.log("时间/日期(D) menu clicked!")}}],width:"218px",left:"52px"},{title:"格式(O)",menuItems:[{title:"自动换行(W)",shortcut:"",enabled:!0,handler:function(){console.log("自动换行(W) menu clicked!")}},{title:"字体(F)...",shortcut:"",enabled:!0,handler:function(){$dlgFont.show()}}],width:"156px",left:"106px"},{title:"查看(V)",menuItems:[{title:"状态栏(S)",shortcut:"",enabled:!0,handler:function(){console.log("查看状态栏(S) menu clicked!")}}],width:"138px",left:"162px"},{title:"帮助(H)",menuItems:[{title:"查看帮助(H)",shortcut:"",enabled:!0,handler:function(){console.log("查看帮助(H) menu clicked!")}}],width:"166px",left:"216px"}];$editor=function(){var e=$('<div class="notepad-editor"><textarea spellcheck="false" auto-size="none"></textarea></div>'),s=e.find("textarea"),i={posHandler:null,contentHandler:null,wrap:!1},t=!1;function a(){var t=s.val().substr(0,s[0].selectionStart).split("\n");return t[t.length-1].length+1}function c(){return s.val().substr(0,s[0].selectionStart).split("\n").length}function n(t){t?(s.attr("wrap","soft"),s.css({"overflow-x":"hidden"})):(s.attr("wrap","off"),s.css({"overflow-x":"scroll"}))}return s.keyup(function(){i.posHandler(c(),a()),i.contentHandler(""!==s.val())}),s.keypress(function(){i.posHandler(c(),a())}),s.mousedown(function(){t=!0}),s.mouseup(function(){t=!1}),s.mousemove(function(){t&&i.posHandler(c(),a())}),s.click(function(){i.posHandler(c(),a())}),{show:function(t){$.extend(i,t),$("body").append(e),s.trigger("focus"),n(i.wrap)},resize:function(t){t?e.css({bottom:"21px"}):e.css({bottom:"0"})},focus:function(){s.focus()},getTotalLn:function(){return s.val().split("\n").length},getRow:c,getCol:a,setWrap:n,selectAll:function(){var t=s.val().length;s[0].selectionStart=0,s[0].selectionEnd=t,s.select()},insertDataTime:function(){var t=s.val(),e=t.substring(0,s[0].selectionStart),n=t.substring(s[0].selectionEnd,t.length);t=e+(new Date).toLocaleString()+n,s.val(t),s.focus(),i.posHandler(c(),a())},gotoLn:function(t){for(var e=0,n=s.val().split("\n"),l=0;l<t-1;l++)e+=n[l].length+1;s[0].selectionStart=e,s[0].selectionEnd=e,s.focus(),i.posHandler(c(),a())},bingSearch:function(){var t=s[0].selectionStart,e=s[0].selectionEnd;if(t===e)window.open("https://cn.bing.com/","_blank");else{var n=s.val().substring(t,e);window.open("https://cn.bing.com/search?q="+n,"_blank")}},search:function(t){var e=s.val(),n=t.content;t.capitalSense||(e=e.toLowerCase(),n=n.toLowerCase());var l,o=s[0].selectionEnd;l="down"===t.direction?e.indexOf(n,o):e.substr(0,s[0].selectionStart).lastIndexOf(n),-1!==l?(s[0].selectionStart=l,s[0].selectionEnd=l+n.length,i.posHandler(c(),a())):alert('找不到 "'+t.content+'"')},setFont:function(t){s.css({"font-family":t.family,"font-size":t.size+"pt"}),"斜体"!==t.style?"粗体"!==t.style?"粗偏斜体"!==t.style||s.css({"font-weight":"bold","font-style":"italic"}):s.css({"font-weight":"bold"}):s.css({"font-style":"italic"})}}}();var $dlgFont=function(){var t=$('<div class="notepad-dlg-mask notepad-dlg-font"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">字体</p><span class="close-btn">✖</span></div><div class="main notepad-dlg-main"><div class="font-family"><p>字体(F):</p></div><div class="font-style"><p>字形(Y):</p></div><div class="font-size"><p>大小(S):</p></div><fieldset class="sample"><legend>示例</legend><p>AaBbYyZz</p></fieldset><div class="script"><label>脚本(R):<br><select><option value="西欧语言">西欧语言</option><option value="中文 GB2312">中文 GB2312</option></select></label></div><input class="btn-ok btn" type="button" value="确定"><input class="btn-cancel btn" type="button" value="取消"></div></div></div>'),o=t.find(".btn-ok"),s=t.find(".close-btn"),i=t.find(".btn-cancel"),a=t.find(".notepad-dlg-titlebar");function c(){t.remove()}return{show:function(){var e,n,l;$("body").append(t),e=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],n=["常规","斜体","粗体","粗偏斜体"],l=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],(new comList).show({container:".notepad-dlg-font .font-family",width:"176px",list:e,isFont:!0,selectHandler:function(t){console.log(e[t])}}),(new comList).show({container:".notepad-dlg-font .font-style",select:3,width:"132px",list:n,isFontStyle:!0,selectHandler:function(t){console.log(n[t])}}),(new comList).show({container:".notepad-dlg-font .font-size",width:"64px",list:l,selectHandler:function(t){console.log(l[t])}}),t.find(".dialogbox").draggable({handle:a}),s.click(c),i.click(c),o.click(c)}}}();function comList(){var o,n=$('<div class="notepad-com-list"><input class="editor" type="text"><br><ul class="list"></ul></div>'),l=n.find(".editor"),s=n.find(".list"),i={container:"",list:[],select:0,width:"200px",isFont:!1,isFontStyle:!1,selectHandler:null};function e(){var t,e=$(i.container).find(".notepad-com-list");0!==e.length&&e.remove(),$(i.container).append(n),n.css({width:i.width}),function(){var t,e,n,l=0;if(i.isFont)for(l=0;l<i.list.length;l++)(t=$('<li class="item"></li>')).css({"font-family":i.list[l]}),s.append(t.html(i.list[l]));else if(i.isFontStyle)for(l=0;l<i.list.length;l++)t=$('<li class="item"></li>'),e=t,"斜体"!==(n=i.list[l])?"粗体"!==n?"粗偏斜体"!==n||e.css({"font-weight":"bold","font-style":"italic"}):e.css({"font-weight":"bold"}):e.css({"font-style":"italic"}),s.append(t.html(i.list[l]));else for(l=0;l<i.list.length;l++)t=$('<li class="item"></li>'),s.append(t.html(i.list[l]));o=s.find(".item")}(),t=i.select,$(o[t]).addClass("selected"),l.val(i.list[t]),l.select()}this.show=function(t){$.extend(i,t),e(),s.click(function(t){$(o[i.select]).removeClass("selected"),i.select=i.list.indexOf($(t.target).html()),$(o[i.select]).addClass("selected"),l.val(i.list[i.select]),l.select(),i.selectHandler(i.select)}),l.keyup(function(){var t=0;for(t=0;t<i.list.length&&0!==i.list[t].indexOf(l.val());t++);t!==i.list.length&&(o[t].scrollIntoView({behavior:"smooth",block:"start"}),$(o[i.select]).removeClass("selected"),$(o[t]).addClass("selected"),i.select=t)})}}var $menubar=function(){var a,c=$('<div class="notepad-menubar"></div>'),d=[],r=-1;function e(){!function(){for(var t=$('<ul class="menu-title"></ul>'),e=0;e<a.length;e++){var n=$('<li class="title"></li>');n.html(a[e].title),n.attr("data-id",e),t.append(n),n.click(function(){var t=Number(this.dataset.id);r=-1===r?(d[t].css({display:"inline-block"}),t):r!==t?(d[r].css({display:"none"}),d[t].css({display:"inline-block"}),t):(d[r].css({display:"none"}),-1)}),n.hover(function(){if(-1!==r){var t=Number(this.dataset.id);d[r].css({display:"none"}),d[t].css({display:"inline-block"}),r=t}})}c.append(t)}(),function(){for(var t=0;t<a.length;t++){for(var e=$('<ul class="menus"></ul>'),n=a[t].menuItems,l=0;l<n.length;l++)if("hr"!==n[l].title){var o=$('<li class="menu-item"></li>');if(o.html(n[l].title),o.attr("data-x",t),o.attr("data-y",l),""!==n[l].shortcut){var s=$('<span class="shortcut"></span>');s.html(n[l].shortcut),o.append(s)}n[l].enabled||o.addClass("disabled"),e.append(o),o.click(function(){if(!$(this).hasClass("disabled")){var t=this.dataset.x,e=this.dataset.y;a[t].menuItems[e].handler(),d[t].css({display:"none"}),r=-1}})}else{var i=$('<li class="menu-hr"></li>');e.append(i)}e.css({width:a[t].width,left:a[t].left,display:"none"}),c.append(e),d.push(e)}}(),$("body").append(c)}return{show:function(t){a=t,e()},checked:function(t,e,n){var l=d[t].find(".menu-item")[e];n?$(l).prepend($('<span class="checked">✓</span>')[0]):$(l).find(".checked").remove()},enabled:function(t,e,n){var l=d[t].find(".menu-item")[e];n?$(l).removeClass("disabled"):$(l).addClass("disabled")}}}();